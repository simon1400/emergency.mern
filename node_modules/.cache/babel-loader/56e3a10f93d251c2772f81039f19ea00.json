{"ast":null,"code":"import _regeneratorRuntime from \"/Users/dmytropechunka/Desktop/main/projects/slavik/mern/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/dmytropechunka/Desktop/main/projects/slavik/mern/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/Users/dmytropechunka/Desktop/main/projects/slavik/mern/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/dmytropechunka/Desktop/main/projects/slavik/mern/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/dmytropechunka/Desktop/main/projects/slavik/mern/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/dmytropechunka/Desktop/main/projects/slavik/mern/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/dmytropechunka/Desktop/main/projects/slavik/mern/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/dmytropechunka/Desktop/main/projects/slavik/mern/src/app/routes/test-full/index.js\";\nimport React, { Component } from \"react\";\nimport Page from \"../../components/page\";\nimport axios from \"axios\";\nimport Cookies from \"js-cookie\";\n\nvar TestFull =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(TestFull, _Component);\n\n  function TestFull(props) {\n    var _this;\n\n    _classCallCheck(this, TestFull);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(TestFull).call(this, props));\n\n    _this.getResult = function (resData, currentUser) {\n      resData.map(function (data) {\n        return !data.done && data.userId === currentUser._id ? _this.setState({\n          resultId: data._id,\n          currentAsk: data.currentAsk,\n          idTest: data.idTest,\n          answers: data.answers\n        }) : false;\n      });\n    };\n\n    _this.updateAnswers = function (e) {\n      var answers = _this.onCheckedAnswers(_this.state.checkedName, _this.state.checkedBody);\n\n      var now = new Date();\n      var date = now.getDate() + \".\" + now.getMonth() + \".\" + now.getFullYear() + \" \" + now.getHours() + \":\" + now.getMinutes();\n\n      if (e === \"next\") {\n        _this.setState({\n          currentAsk: _this.state.currentAsk + 1,\n          answers: answers,\n          date: date\n        }, function () {\n          return console.log(\"next update state!\");\n        });\n      } else {\n        _this.setState({\n          answers: answers,\n          date: date\n        });\n      }\n    };\n\n    _this.onPrev = function (e) {\n      _this.setState({\n        currentAsk: _this.state.currentAsk - 1,\n        prev: true\n      }, function () {\n        return console.log(\"prev curretn decrement\");\n      });\n    };\n\n    _this.onNext =\n    /*#__PURE__*/\n    function () {\n      var _ref = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee(e) {\n        var currentUser, data;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                currentUser = Cookies.getJSON(\"user\");\n\n                if (!(!_this.state.prev && !_this.state.resultId)) {\n                  _context.next = 4;\n                  break;\n                }\n\n                _context.next = 4;\n                return axios.get(\"http://server.dotaznik.hardart.cz/result/all/\" + _this.props.match.params.id).then(function (res) {\n                  return res.data ? _this.getResult(res.data, currentUser) : false;\n                });\n\n              case 4:\n                _context.next = 6;\n                return _this.updateAnswers(\"next\");\n\n              case 6:\n                data = _this.sendObjectData(_this.state, false);\n\n                if (!(_this.state.currentAsk === 1 && !_this.state.resultId)) {\n                  _context.next = 10;\n                  break;\n                }\n\n                _context.next = 10;\n                return axios.post(\"http://server.dotaznik.hardart.cz/result/create/\", data).then(function (res) {\n                  return console.log(\"create data next!\");\n                });\n\n              case 10:\n                if (!(_this.state.currentAsk && _this.state.resultId)) {\n                  _context.next = 13;\n                  break;\n                }\n\n                _context.next = 13;\n                return axios.get(\"http://server.dotaznik.hardart.cz/result/\" + _this.state.resultId).then(function (res) {\n                  var data = res.data[0];\n\n                  if (data && !data.done) {\n                    _this.setState({\n                      resultId: data._id,\n                      currentAsk: data.currentAsk,\n                      idTest: data.idTest,\n                      answers: data.answers\n                    });\n                  }\n                }).then(function () {\n                  axios.post(\"http://server.dotaznik.hardart.cz/result/update/\" + _this.state.resultId, data).then(console.log(\"update next\"));\n                });\n\n              case 13:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }();\n\n    _this.onFinish =\n    /*#__PURE__*/\n    _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee2() {\n      var data;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return _this.updateAnswers(\"finish\");\n\n            case 2:\n              data = _this.sendObjectData(_this.state, true);\n              _context2.next = 5;\n              return axios.get(\"http://server.dotaznik.hardart.cz/result/all/\" + _this.props.match.params.id).then(function (res) {\n                return res.data ? res.data.map(function (item) {\n                  return !item.done && data.userId === item.userId ? (_this.setState({\n                    resultId: item._id,\n                    currentAsk: item.currentAsk,\n                    idTest: item.idTest,\n                    answers: item.answers\n                  }), axios.post(\"http://server.dotaznik.hardart.cz/result/update/\" + item._id, data).then(function () {\n                    return window.location.href = \"/results/pacient\";\n                  })) : false;\n                }) : false;\n              });\n\n            case 5:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    _this.sendObjectData = function (state, done) {\n      var data = {\n        idTest: state.test._id,\n        nameTest: state.test.nameTest,\n        currentAsk: state.currentAsk,\n        answers: state.answers,\n        date: state.date,\n        done: done,\n        userId: state.userId\n      };\n      return data;\n    };\n\n    _this.onHandleCheckbox = function (e) {\n      var answers = _this.onCheckedAnswers(e.target.value, e.target.dataset.body);\n\n      _this.setState({\n        checkedName: e.target.value,\n        checkedBody: e.target.dataset.body,\n        answers: answers\n      });\n    };\n\n    _this.onCheckedAnswers = function (value, body) {\n      var answers = _this.state.answers;\n      var index;\n      var answer = {\n        nameAsk: _this.state.test.questions[_this.state.currentAsk].nameQuestion,\n        checkedValue: value,\n        checkedBody: body\n      };\n\n      if (answers.find(function (x) {\n        return x.nameAsk === _this.state.test.questions[_this.state.currentAsk].nameQuestion;\n      })) {\n        index = answers.findIndex(function (x) {\n          return x.nameAsk === _this.state.test.questions[_this.state.currentAsk].nameQuestion;\n        });\n        answers[index] = answer;\n      } else {\n        answers.push(answer);\n      }\n\n      return answers;\n    };\n\n    _this.state = {\n      resultId: \"\",\n      test: {},\n      currentAsk: 0,\n      answers: [],\n      checkedName: \"\",\n      checkedBody: \"\",\n      date: \"\",\n      done: false,\n      userId: \"\",\n      prev: false\n    };\n    return _this;\n  }\n\n  _createClass(TestFull, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      var currentUser = Cookies.getJSON(\"user\");\n      axios.get(\"http://server.dotaznik.hardart.cz/admin/test/\" + this.props.match.params.id).then(function (res) {\n        _this2.setState({\n          test: res.data\n        });\n      });\n      axios.get(\"http://server.dotaznik.hardart.cz/result/all/\" + this.props.match.params.id).then(function (res) {\n        return res.data ? (_this2.setState({\n          userId: currentUser._id,\n          resultId: \"\",\n          currentAsk: 0,\n          answers: [],\n          checkedName: \"\",\n          checkedBody: \"\",\n          date: \"\",\n          done: false\n        }), _this2.getResult(res.data, currentUser)) : false;\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      var test = this.state.test;\n      var currentAsk = this.state.currentAsk;\n      var answers = this.state.answers;\n      return React.createElement(Page, {\n        id: \"homepage\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 249\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"uk-container\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 250\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"uk-grid uk-child-width-1-1\",\n        \"uk-grid\": \"\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 251\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 252\n        },\n        __self: this\n      }, React.createElement(\"h1\", {\n        className: \"uk-heading-divider uk-text-center\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 253\n        },\n        __self: this\n      }, test.nameTest), React.createElement(\"h3\", {\n        className: \"uk-heading-divider\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 257\n        },\n        __self: this\n      }, test.questions ? test.questions[currentAsk].nameQuestion : false), React.createElement(\"form\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 263\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"uk-margin uk-grid-small uk-child-width-1-1 uk-grid\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 264\n        },\n        __self: this\n      }, Object.entries(test).length ? test.questions[currentAsk].asks.map(function (ask, indexAsk) {\n        return React.createElement(\"label\", {\n          key: indexAsk,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 267\n          },\n          __self: this\n        }, answers.length >= 1 && currentAsk < answers.length ? answers[currentAsk].checkedValue === ask.nameAsk ? React.createElement(\"input\", {\n          className: \"uk-radio\",\n          onClick: _this3.onHandleCheckbox,\n          type: \"radio\",\n          value: ask.nameAsk,\n          \"data-body\": ask.valueAsk,\n          name: \"radio-\".concat(currentAsk),\n          checked: true,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 271\n          },\n          __self: this\n        }) : React.createElement(\"input\", {\n          className: \"uk-radio\",\n          onClick: _this3.onHandleCheckbox,\n          type: \"radio\",\n          value: ask.nameAsk,\n          \"data-body\": ask.valueAsk,\n          name: \"radio-\".concat(currentAsk),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 281\n          },\n          __self: this\n        }) : React.createElement(\"input\", {\n          className: \"uk-radio\",\n          onClick: _this3.onHandleCheckbox,\n          type: \"radio\",\n          value: ask.nameAsk,\n          \"data-body\": ask.valueAsk,\n          name: \"radio-\".concat(currentAsk),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 291\n          },\n          __self: this\n        }), ask.nameAsk);\n      }) : false)), React.createElement(\"progress\", {\n        id: \"js-progressbar\",\n        className: \"uk-progress\",\n        value: this.state.currentAsk + 1,\n        max: test.questions ? test.questions.length : 0,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 307\n        },\n        __self: this\n      }), React.createElement(\"hr\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 313\n        },\n        __self: this\n      }), test.questions ? currentAsk === test.questions.length - 1 ? React.createElement(\"button\", {\n        className: \"uk-button uk-button-primary uk-align-right\",\n        onClick: this.onFinish,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 316\n        },\n        __self: this\n      }, \"Finish\") : React.createElement(\"button\", {\n        className: \"uk-button uk-button-primary uk-align-right\",\n        onClick: this.onNext,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 323\n        },\n        __self: this\n      }, \"Next\") : \"\", currentAsk >= 1 ? React.createElement(\"button\", {\n        className: \"uk-button uk-button-primary uk-align-right\",\n        onClick: this.onPrev,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 334\n        },\n        __self: this\n      }, \"Prev\") : false))));\n    }\n  }]);\n\n  return TestFull;\n}(Component);\n\nexport { TestFull as default };","map":{"version":3,"sources":["/Users/dmytropechunka/Desktop/main/projects/slavik/mern/src/app/routes/test-full/index.js"],"names":["React","Component","Page","axios","Cookies","TestFull","props","getResult","resData","currentUser","map","data","done","userId","_id","setState","resultId","currentAsk","idTest","answers","updateAnswers","e","onCheckedAnswers","state","checkedName","checkedBody","now","Date","date","getDate","getMonth","getFullYear","getHours","getMinutes","console","log","onPrev","prev","onNext","getJSON","get","match","params","id","then","res","sendObjectData","post","onFinish","item","window","location","href","test","nameTest","onHandleCheckbox","target","value","dataset","body","index","answer","nameAsk","questions","nameQuestion","checkedValue","find","x","findIndex","push","Object","entries","length","asks","ask","indexAsk","valueAsk"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport Page from \"../../components/page\";\nimport axios from \"axios\";\nimport Cookies from \"js-cookie\";\n\nexport default class TestFull extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      resultId: \"\",\n      test: {},\n      currentAsk: 0,\n      answers: [],\n      checkedName: \"\",\n      checkedBody: \"\",\n      date: \"\",\n      done: false,\n      userId: \"\",\n      prev: false\n    };\n  }\n\n  componentDidMount() {\n    let currentUser = Cookies.getJSON(\"user\");\n\n    axios\n      .get(\"http://server.dotaznik.hardart.cz/admin/test/\" + this.props.match.params.id)\n      .then(res => {\n        this.setState({\n          test: res.data\n        });\n      });\n\n    axios\n      .get(\"http://server.dotaznik.hardart.cz/result/all/\" + this.props.match.params.id)\n      .then(\n        res =>\n          res.data\n            ? (this.setState({\n                userId: currentUser._id,\n                resultId: \"\",\n                currentAsk: 0,\n                answers: [],\n                checkedName: \"\",\n                checkedBody: \"\",\n                date: \"\",\n                done: false\n              }),\n              this.getResult(res.data, currentUser))\n            : false\n      );\n  }\n\n  getResult = (resData, currentUser) => {\n    resData.map(\n      data =>\n        !data.done && data.userId === currentUser._id\n          ? this.setState({\n              resultId: data._id,\n              currentAsk: data.currentAsk,\n              idTest: data.idTest,\n              answers: data.answers\n            })\n          : false\n    );\n  };\n\n  updateAnswers = e => {\n    let answers = this.onCheckedAnswers(\n      this.state.checkedName,\n      this.state.checkedBody\n    );\n\n    var now = new Date();\n    var date =\n      now.getDate() +\n      \".\" +\n      now.getMonth() +\n      \".\" +\n      now.getFullYear() +\n      \" \" +\n      now.getHours() +\n      \":\" +\n      now.getMinutes();\n\n    if (e === \"next\") {\n      this.setState(\n        {\n          currentAsk: this.state.currentAsk + 1,\n          answers: answers,\n          date: date\n        },\n        () => console.log(\"next update state!\")\n      );\n    } else {\n      this.setState({\n        answers: answers,\n        date: date\n      });\n    }\n  };\n\n  onPrev = e => {\n    this.setState(\n      {\n        currentAsk: this.state.currentAsk - 1,\n        prev: true\n      },\n      () => console.log(\"prev curretn decrement\")\n    );\n  };\n\n  onNext = async e => {\n    let currentUser = Cookies.getJSON(\"user\");\n\n    if (!this.state.prev && !this.state.resultId) {\n      await axios\n        .get(\"http://server.dotaznik.hardart.cz/result/all/\" + this.props.match.params.id)\n        .then(\n          res => (res.data ? this.getResult(res.data, currentUser) : false)\n        );\n    }\n\n    await this.updateAnswers(\"next\");\n\n    var data = this.sendObjectData(this.state, false);\n\n    if (this.state.currentAsk === 1 && !this.state.resultId) {\n      await axios\n        .post(\"http://server.dotaznik.hardart.cz/result/create/\", data)\n        .then(res => console.log(\"create data next!\"));\n    }\n\n    if (this.state.currentAsk && this.state.resultId) {\n      await axios\n        .get(\"http://server.dotaznik.hardart.cz/result/\" + this.state.resultId)\n        .then(res => {\n          var data = res.data[0];\n          if (data && !data.done) {\n            this.setState({\n              resultId: data._id,\n              currentAsk: data.currentAsk,\n              idTest: data.idTest,\n              answers: data.answers\n            });\n          }\n        })\n        .then(() => {\n          axios\n            .post(\n              \"http://server.dotaznik.hardart.cz/result/update/\" + this.state.resultId,\n              data\n            )\n            .then(console.log(\"update next\"));\n        });\n    }\n  };\n\n  onFinish = async () => {\n    await this.updateAnswers(\"finish\");\n\n    var data = this.sendObjectData(this.state, true);\n\n    await axios\n      .get(\"http://server.dotaznik.hardart.cz/result/all/\" + this.props.match.params.id)\n      .then(\n        res =>\n          res.data\n            ? res.data.map(\n                item =>\n                  !item.done && data.userId === item.userId\n                    ? (this.setState({\n                        resultId: item._id,\n                        currentAsk: item.currentAsk,\n                        idTest: item.idTest,\n                        answers: item.answers\n                      }),\n                      axios\n                        .post(\n                          \"http://server.dotaznik.hardart.cz/result/update/\" + item._id,\n                          data\n                        )\n                        .then(\n                          () => (window.location.href = \"/results/pacient\")\n                        ))\n                    : false\n              )\n            : false\n      );\n  };\n\n  sendObjectData = (state, done) => {\n    var data = {\n      idTest: state.test._id,\n      nameTest: state.test.nameTest,\n      currentAsk: state.currentAsk,\n      answers: state.answers,\n      date: state.date,\n      done: done,\n      userId: state.userId\n    };\n\n    return data;\n  };\n\n  onHandleCheckbox = e => {\n    let answers = this.onCheckedAnswers(e.target.value, e.target.dataset.body);\n\n    this.setState({\n      checkedName: e.target.value,\n      checkedBody: e.target.dataset.body,\n      answers: answers\n    });\n  };\n\n  onCheckedAnswers = (value, body) => {\n    var answers = this.state.answers;\n    var index;\n    var answer = {\n      nameAsk: this.state.test.questions[this.state.currentAsk].nameQuestion,\n      checkedValue: value,\n      checkedBody: body\n    };\n    if (\n      answers.find(\n        x =>\n          x.nameAsk ===\n          this.state.test.questions[this.state.currentAsk].nameQuestion\n      )\n    ) {\n      index = answers.findIndex(\n        x =>\n          x.nameAsk ===\n          this.state.test.questions[this.state.currentAsk].nameQuestion\n      );\n      answers[index] = answer;\n    } else {\n      answers.push(answer);\n    }\n\n    return answers;\n  };\n\n  render() {\n    var test = this.state.test;\n    var currentAsk = this.state.currentAsk;\n    var answers = this.state.answers;\n    return (\n      <Page id=\"homepage\">\n        <div className=\"uk-container\">\n          <div className=\"uk-grid uk-child-width-1-1\" uk-grid=\"\">\n            <div>\n              <h1 className=\"uk-heading-divider uk-text-center\">\n                {test.nameTest}\n              </h1>\n\n              <h3 className=\"uk-heading-divider\">\n                {test.questions\n                  ? test.questions[currentAsk].nameQuestion\n                  : false}\n              </h3>\n\n              <form>\n                <div className=\"uk-margin uk-grid-small uk-child-width-1-1 uk-grid\">\n                  {Object.entries(test).length\n                    ? test.questions[currentAsk].asks.map((ask, indexAsk) => (\n                        <label key={indexAsk}>\n                          {answers.length >= 1 &&\n                          currentAsk < answers.length ? (\n                            answers[currentAsk].checkedValue === ask.nameAsk ? (\n                              <input\n                                className=\"uk-radio\"\n                                onClick={this.onHandleCheckbox}\n                                type=\"radio\"\n                                value={ask.nameAsk}\n                                data-body={ask.valueAsk}\n                                name={`radio-${currentAsk}`}\n                                checked\n                              />\n                            ) : (\n                              <input\n                                className=\"uk-radio\"\n                                onClick={this.onHandleCheckbox}\n                                type=\"radio\"\n                                value={ask.nameAsk}\n                                data-body={ask.valueAsk}\n                                name={`radio-${currentAsk}`}\n                              />\n                            )\n                          ) : (\n                            <input\n                              className=\"uk-radio\"\n                              onClick={this.onHandleCheckbox}\n                              type=\"radio\"\n                              value={ask.nameAsk}\n                              data-body={ask.valueAsk}\n                              name={`radio-${currentAsk}`}\n                            />\n                          )}\n                          {ask.nameAsk}\n                        </label>\n                      ))\n                    : false}\n                </div>\n              </form>\n\n              <progress\n                id=\"js-progressbar\"\n                className=\"uk-progress\"\n                value={this.state.currentAsk + 1}\n                max={test.questions ? test.questions.length : 0}\n              />\n              <hr />\n              {test.questions ? (\n                currentAsk === test.questions.length - 1 ? (\n                  <button\n                    className=\"uk-button uk-button-primary uk-align-right\"\n                    onClick={this.onFinish}\n                  >\n                    Finish\n                  </button>\n                ) : (\n                  <button\n                    className=\"uk-button uk-button-primary uk-align-right\"\n                    onClick={this.onNext}\n                  >\n                    Next\n                  </button>\n                )\n              ) : (\n                \"\"\n              )}\n              {currentAsk >= 1 ? (\n                <button\n                  className=\"uk-button uk-button-primary uk-align-right\"\n                  onClick={this.onPrev}\n                >\n                  Prev\n                </button>\n              ) : (\n                false\n              )}\n            </div>\n          </div>\n        </div>\n      </Page>\n    );\n  }\n}\n"]},"metadata":{},"sourceType":"module"}